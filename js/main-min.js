!function($){$.widget("kataev.colorpicker",{options:{isCollapsed:!0,valueR:255,valueG:255,valueB:255,value:""},_create:function(){$(this.element).addClass("ui-colorpicker"),$("<input/>",{"class":"ui-colorpicker-hex"}).appendTo(this.element),$("<div></div>",{"class":"ui-colorpicker-rgb-sliders"}).appendTo(this.element),$("<div></div>",{"class":"ui-colorpicker-red-slider",color:"red"}).appendTo(this.element.children(".ui-colorpicker-rgb-sliders")),$("<div></div>",{"class":"ui-colorpicker-green-slider",color:"green"}).appendTo(this.element.children(".ui-colorpicker-rgb-sliders")),$("<div></div>",{"class":"ui-colorpicker-blue-slider",color:"blue"}).appendTo(this.element.children(".ui-colorpicker-rgb-sliders")),$(".ui-colorpicker-red-slider").slider({animate:!0,min:0,max:255,range:"min",value:this.options.valueR}),$(".ui-colorpicker-green-slider").slider({animate:!0,min:0,max:255,range:"min",value:this.options.valueG}),$(".ui-colorpicker-blue-slider").slider({animate:!0,min:0,max:255,range:"min",value:this.options.valueB}),this.setUpListeners(),this.setSliders()},_setOption:function(){this.setRGB(this.options.value),this.setSliders()},_init:function(){this.setRGB(this.options.value),this.element.find(".ui-colorpicker-hex").val(this.options.value),this.setBG(this.options.value),this.setSliders()},destroy:function(){},getHEX:function(){var e=parseInt(this.options.valueR).toString(16),i=parseInt(this.options.valueG).toString(16),t=parseInt(this.options.valueB).toString(16);return 1===e.length&&(this.options.valueR>15?e+="0":e="0"+e),1===i.length&&(this.options.valueG>15?i+="0":i="0"+i),1===t.length&&(this.options.valueB>15?t+="0":t="0"+t),e+i+t},setRGB:function(e){6===e.length&&(this.options.valueR=parseInt(e.substring(0,2),16),this.options.valueG=parseInt(e.substring(2,4),16),this.options.valueB=parseInt(e.substring(4,6),16))},setBG:function(e,i){this.element.children(".ui-colorpicker-hex").css("background-color","#"+e),this.options.value=e;var t={};t.handle=this.element.children(".ui-colorpicker-hex").get(),t.value=this.options.value,this._trigger("change",i,t)},value:function(){return this.options.hex},changeColor:function(e,i){switch($(e.target).attr("color")){case"red":e.data.options.valueR=i.value;break;case"green":e.data.options.valueG=i.value;break;case"blue":e.data.options.valueB=i.value}e.data.element.find(".ui-colorpicker-hex").val(e.data.getHEX()),e.data.setBG(e.data.getHEX())},changeByKey:function(e){e.data.setRGB($(e.target).val()),console.log(e.data.getHEX()),e.data.setBG(e.data.getHEX()),e.data.setSliders()},setSliders:function(){this.element.find(".ui-colorpicker-red-slider").slider("value",this.options.valueR),this.element.find(".ui-colorpicker-green-slider").slider("value",this.options.valueG),this.element.find(".ui-colorpicker-blue-slider").slider("value",this.options.valueB),console.log(this.options)},setUpListeners:function(){this.element.on({mouseenter:function(){$(this).children(".ui-colorpicker-rgb-sliders").slideDown(200)},mouseleave:function(){$(this).find(".ui-slider-handle").hasClass("ui-state-active")||$(this).children(".ui-colorpicker-rgb-sliders").slideUp(200)}}),this.element.children(".ui-colorpicker-hex").on("keyup",this,this.changeByKey),this.element.find(".ui-colorpicker-red-slider, .ui-colorpicker-green-slider, .ui-colorpicker-blue-slider").bind("slide",this,this.changeColor)}})}(jQuery),function(){var e={settings:{"border-radius":{type:"slider",initial:{animate:!0,min:0,max:50,range:"min",value:10}},"background-color":{type:"colorpicker",initial:{value:"24D7B9"}},"border-size":{type:"slider",initial:{animate:!0,min:0,max:15,range:"min",value:0}},width:{type:"slider",initial:{animate:!0,min:0,max:50,range:"min",value:25}},heigth:{type:"slider",initial:{animate:!0,min:0,max:50,range:"min",value:5}},"border-color":{type:"colorpicker",initial:{value:"ffffff"}},"text-color":{type:"colorpicker",initial:{value:"137d6b"}},"font-size":{type:"slider",initial:{animate:!0,min:4,max:36,range:"min",value:16}},"x-offset":{type:"slider",initial:{animate:!0,min:0,max:50,range:"min",value:0}},"y-offset":{type:"slider",initial:{animate:!0,min:0,max:50,range:"min",value:3}},"shadow-blur":{type:"slider",initial:{animate:!0,min:0,max:50,range:"min",value:0}},"shadow-color":{type:"colorpicker",initial:{value:"137d6b"}}},currentValue:{},initialize:function(){this.setUpListeners(),this.setUpOptoinsUI(),this.initTabs(),this.initModal()},setUpListeners:function(){$(this.getIDs("slider")).bind("slide",this.changeCurrentValue),$(this.getIDs("colorpicker")).bind("colorpickerchange",this.changeCurrentValue),$("#submit").on("click",this.sendMail),$("#email").on("keyup",function(){$("#email").removeClass("alert").tooltip("hide")}),$("#button-text").on("keyup",this.setText)},initTabs:function(){$("#optionTabs a").click(function(e){e.preventDefault(),$(this).tab("show")})},initModal:function(){$("#modal").dialog({modal:!0,resizable:!1,title:"Отправка письма",closeText:"Закрыть",autoOpen:!1})},getIDs:function(i){var t="";return $.each(e.settings,function(e,n){n.type===i&&(t+="#"+e+", ")}),t.slice(0,t.length-2)},setUpOptoinsUI:function(){$.each(this.settings,function(e,i){switch(i.type){case"slider":$("#"+e).slider(i.initial);break;case"colorpicker":$("#"+e).colorpicker(i.initial)}}),$.each(this.settings,function(i,t){e.currentValue[i]=t.initial.value}),this.setText(),this.outputValue()},changeCurrentValue:function(i,t){var n=$(t.handle).parent().attr("id");console.log(n),e.currentValue[n]=t.value,e.outputValue()},setText:function(){var i=$("#button-text").val();$("#result-button").text(i),e.currentValue.text=i,console.log(e.currentValue.text),e.outputValue()},outputValue:function(){var i='<button id="my-button">',t="";$.each(this.currentValue,function(n,a){switch(n){case"border-size":a>0&&(t+="border: "+a+"px solid #"+e.currentValue["border-color"]+"; \n");break;case"border-radius":a>0&&(t+="border-radius: "+a+"px; \n");break;case"width":a>0&&(t+="padding: "+e.currentValue.heigth+"px "+a+"px; \n");break;case"heigth":a>0&&0===e.currentValue.width&&(t+="padding: "+a+"px 0px; \n");break;case"background-color":a.length&&(t+="background-color: #"+a+"; \n");break;case"font-size":a>0&&(t+="font-size: "+a+"px; \n");break;case"text-color":a.length&&(t+="color: #"+a+"; \n");break;case"x-offset":a>0&&(t+="box-shadow: "+a+"px "+e.currentValue["y-offset"]+"px "+e.currentValue["shadow-blur"]+"px #"+e.currentValue["shadow-color"]+"; \n");break;case"y-offset":a>0&&0===e.currentValue["x-offset"]&&(t+="box-shadow: 0px "+a+"px "+e.currentValue["shadow-blur"]+"px #"+e.currentValue["shadow-color"]+"; \n");break;case"shadow-blur":a>0&&0===e.currentValue["x-offset"]&&0===e.currentValue["y-offset"]&&(t+="box-shadow: 0px 0px "+a+"px #"+e.currentValue["shadow-color"]+"; \n");break;case"text":i+=a}}),$("#result-button").attr("style",t.slice(0,t.length-3)),i+="</button>",$("#result-html").text(i),$("#result-css").text(""!==t?"#my-button {\n"+t+"}":"")},sendMail:function(){var i=$("#email"),t="mail="+$("#email").val()+"&html="+$("#result-html").text()+"&css="+$("#result-css").text();e.valid()?($.ajax({type:"post",url:"send-mail.php",cache:!1,data:t,success:function(e){$("#modal").text(e),$("#modal").dialog("open")}}),i.addClass("success")):i.addClass("alert").tooltip({title:"Введите корректный Email",trigger:"manual"}).tooltip("show")},valid:function(){var e=/^([a-zA-Z0-9_.-])+@([a-zA-Z0-9_.-])+\.([a-zA-Z])+([a-zA-Z])+/,i=$("#email").val();return i.length?e.test(i):!1}};e.initialize()}();